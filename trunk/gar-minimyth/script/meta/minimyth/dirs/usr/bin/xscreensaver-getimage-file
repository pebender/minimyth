#!/bin/sh

prog_name=`/usr/bin/basename "$0"`

image_root=
for arg in $* ; do
     if ! `echo "${arg}" | grep -q -e '^-' > /dev/null 2>&1` ; then    
         image_root="${arg}"
     fi
done
if /usr/bin/test ! -d "${image_root}" ; then
   /bin/echo ""
   /bin/echo "usage: ${prog_name} <image-directory>"
   /bin/echo ""
    exit 1
fi

image_count=`/usr/bin/find "${image_root}"| /bin/grep -i -e '\.jpg$'| /usr/bin/wc -l`
if /usr/bin/test ! ${image_count} -gt 0 ; then
   /bin/echo ""
   /bin/echo "error: no images found in directory \"${image_root}\""
   /bin/echo ""
    exit 1
fi

image_index=$(( ( (${RANDOM} * ${image_count}) >> 16 ) + 1 ))
/usr/bin/test ${image_index} -lt 1              && image_index=1
/usr/bin/test ${image_index} -gt ${image_count} && image_index=${image_count}

image_file=`/usr/bin/find "${image_root}"| /bin/grep -i -e '\.jpg$' | /usr/bin/head -n ${image_index} | /usr/bin/tail -n 1`

/bin/echo "${image_file}"

exit 0
