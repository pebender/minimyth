#!/bin/sh

. /etc/rc.d/functions

commandlist=`cat /etc/rc.d/functions | grep '^mm_[^ ]*()' | sed 's%([^ ]*)\(\).*%\1%' | sed 's%^mm_%%' | sort`

usage() {
    echo "usage:"
    echo "  mm_command command [command_args ...]"
    echo ""
    echo "  were 'command' is one of the following commands:"
    for command in ${commandlist} ; do
        echo "    ${command}"
    done
    echo "  and 'command_args' are the args for 'command'."
}

# valid if the first argument is a command.
valid=0
for command in ${commandlist} ; do
    if [ "${command}" = "$1" ] ; then
        valid=1
    fi
done
if [ ${valid} -eq 0 ] ; then
    usage
    exit 1
fi

IFS="~"

command=
arglist=
for arg in $@ ; do
    if [ -z ${command} ] ; then
        command=${arg}
    else
        if [ -z ${arglist} ] ; then
            arglist="${arg}"
        else
            arglist="${arglist}${IFS}${arg}"
        fi
    fi
done

mm_${command} ${arglist}
