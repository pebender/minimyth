#!/bin/sh

dev_base=$(basename ${DEVNAME})

case ${dev_base} in
    hd[a-z])
	dev_list=`ls -l /dev | grep "${dev_base}$" | sed 's% *-> *[^ ]*%%' | sed 's%.* %/dev/%'`
        case ${ACTION} in
            add)
                for dev in ${dev_list} ; do
                    mkdir -p /mnt/${dev}
                done
                ;;
            remove)
                for dev in ${dev_list} ; do
                    rmdir /mnt/${dev}
                done
                ;;
        esac
        ;;
    sd[a-z])
	dev_list=`ls -l /dev | grep "${dev_base}$" | sed 's% *-> *[^ ]*%%' | sed 's%.* %%'`
        case ${ACTION} in
            add)
                for dev in ${dev_list} ; do
                    mkdir -p /mnt/${dev}
                    mount -t auto ${dev} /mnt/${dev}
                done
                ;;
            remove)
                for dev in ${dev_list} ; do
                    umount -l /mnt/${dev}
                    rmdir /mnt/${dev}
                done
                ;;
        esac
        ;;
    sr[0-9]*)
	dev_list=`ls -l /dev | grep "${dev_base}$" | sed 's% *-> *[^ ]*%%' | sed 's%.* %%'`
        case ${ACTION} in
            add)
                for dev in ${dev_list} ; do
                    mkdir -p /mnt/${dev}
                done
                ;;
            remove)
                for dev in ${dev_list} ; do
                    rmdir /mnt/${dev}
                done
                ;;
        esac
        ;;
esac
