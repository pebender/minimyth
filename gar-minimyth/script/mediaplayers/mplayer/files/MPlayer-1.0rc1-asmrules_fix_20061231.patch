diff -Naur MPlayer-1.0rc1-old/stream/realrtsp/asmrp.c MPlayer-1.0rc1-new/stream/realrtsp/asmrp.c
--- MPlayer-1.0rc1-old/stream/realrtsp/asmrp.c	2006-10-22 15:32:25.000000000 -0700
+++ MPlayer-1.0rc1-new/stream/realrtsp/asmrp.c	2007-01-03 06:31:07.000000000 -0800
@@ -40,6 +40,7 @@
 #include <stdlib.h>
 #include <stdio.h>
 #include <string.h>
+#include "asmrp.h"
 
 /*
 #define LOG
@@ -645,8 +646,10 @@
 #ifdef LOG
       printf ("rule #%d is true\n", rule_num);
 #endif
-      matches[num_matches] = rule_num;
-      num_matches++;
+      if(num_matches < MAX_RULEMATCHES - 1)
+        matches[num_matches++] = rule_num;
+      else
+        printf("Ignoring matched asm rule %d, too many matched rules.\n", rule_num);
     }
 
     rule_num++;
diff -Naur MPlayer-1.0rc1-old/stream/realrtsp/asmrp.h MPlayer-1.0rc1-new/stream/realrtsp/asmrp.h
--- MPlayer-1.0rc1-old/stream/realrtsp/asmrp.h	2006-10-22 15:32:25.000000000 -0700
+++ MPlayer-1.0rc1-new/stream/realrtsp/asmrp.h	2007-01-03 06:31:07.000000000 -0800
@@ -40,6 +40,8 @@
 #ifndef HAVE_ASMRP_H
 #define HAVE_ASMRP_H
 
+#define MAX_RULEMATCHES 16
+
 int asmrp_match (const char *rules, int bandwidth, int *matches) ;
 
 #endif
diff -Naur MPlayer-1.0rc1-old/stream/realrtsp/real.c MPlayer-1.0rc1-new/stream/realrtsp/real.c
--- MPlayer-1.0rc1-old/stream/realrtsp/real.c	2006-10-22 15:32:25.000000000 -0700
+++ MPlayer-1.0rc1-new/stream/realrtsp/real.c	2007-01-03 06:31:07.000000000 -0800
@@ -271,7 +271,7 @@
     int j=0;
     int n;
     char b[64];
-    int rulematches[16];
+    int rulematches[MAX_RULEMATCHES];
 
 #ifdef LOG
     printf("calling asmrp_match with:\n%s\n%u\n", desc->stream[i]->asm_rule_book, bandwidth);
