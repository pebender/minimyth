diff -Naur xorg-server-1.3.0.0-old/GL/glx/glxdri.c xorg-server-1.3.0.0-new/GL/glx/glxdri.c
--- xorg-server-1.3.0.0-old/GL/glx/glxdri.c	2007-04-09 12:59:09.000000000 -0700
+++ xorg-server-1.3.0.0-new/GL/glx/glxdri.c	2008-05-10 08:16:53.000000000 -0700
@@ -472,6 +472,9 @@
     else
 	sharePrivate = NULL;
 
+    if (baseShareContext && baseShareContext->isDirect)
+        return NULL;
+
     context = xalloc(sizeof *context);
     if (context == NULL)
 	return NULL;
@@ -490,6 +493,11 @@
 					   0, /* render type */
 					   sharePrivate,
 					   &context->driContext);
+    
+    if (!context->driContext.private) {
+    	xfree(context);
+    	return NULL;
+    }
 
     context->driContext.mode = modes;
 
@@ -815,7 +823,6 @@
 glxDRIEnterVT (int index, int flags)
 {
     __GLXDRIscreen *screen = (__GLXDRIscreen *) __glXgetActiveScreen(index);
-    Bool ret;
 
     LogMessage(X_INFO, "AIGLX: Resuming AIGLX clients after VT switch\n");
 
diff -Naur xorg-server-1.3.0.0-old/hw/kdrive/ephyr/hostx.c xorg-server-1.3.0.0-new/hw/kdrive/ephyr/hostx.c
--- xorg-server-1.3.0.0-old/hw/kdrive/ephyr/hostx.c	2007-03-04 19:15:59.000000000 -0800
+++ xorg-server-1.3.0.0-new/hw/kdrive/ephyr/hostx.c	2008-05-10 08:16:19.000000000 -0700
@@ -40,6 +40,7 @@
 #include <X11/Xatom.h>
 #include <X11/keysym.h>
 #include <X11/extensions/XShm.h>
+#include <X11/Xmd.h>
 
 /*  
  * All xlib calls go here, which gets built as its own .a .
@@ -79,7 +80,7 @@
 
 extern KeySym         EphyrKeymap[];
 
-extern KeySym	      kdKeymap[];
+extern CARD32	      kdKeymap[];
 extern int	      kdMinScanCode;
 extern int	      kdMaxScanCode;
 extern int	      kdMinKeyCode;
diff -Naur xorg-server-1.3.0.0-old/hw/xfree86/modes/xf86Crtc.c xorg-server-1.3.0.0-new/hw/xfree86/modes/xf86Crtc.c
--- xorg-server-1.3.0.0-old/hw/xfree86/modes/xf86Crtc.c	2007-04-16 09:53:50.000000000 -0700
+++ xorg-server-1.3.0.0-new/hw/xfree86/modes/xf86Crtc.c	2008-05-10 08:15:49.000000000 -0700
@@ -1887,7 +1887,9 @@
 	}
     }
     xf86DisableUnusedFunctions(pScrn);
+#ifdef RANDR_12_INTERFACE
     xf86RandR12TellChanged (pScrn->pScreen);
+#endif
     return ok;
 }
 
