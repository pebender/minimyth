#!/usr/bin/perl

use strict;
use warnings;

require File::Spec;
require MiniMyth;
require POSIX;

my $program = shift;

my $minimyth = new MiniMyth;

my $devnull = File::Spec->devnull;

sub daemonize
{
    chdir('/')                 or die;
    open(STDIN, '<', $devnull) or die;
    open(STDOUT,'>', $devnull) or die;
    defined(my $pid = fork())  or die;
    exit(0) if $pid;
    POSIX::setsid()            or die;
    open(STDERR,'>', $devnull) or die;
}

daemonize();

while ($minimyth->application_running($program))
{
    $minimyth->x_screensaver_deactivate();
    sleep 30;
}

1;
